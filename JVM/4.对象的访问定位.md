---
title: 4.对象的访问定位
tags: []
---

&#8195;&#8195;Java程序是通过栈上的reference数据来操作堆上的具体对象。由于reference类型在Java虚拟机规范中只规定了一个指向对象的引用，并没有规定这个引用应该通过何种方式去定位、访问堆中的对象的具体位置，所以对象访问方式也是取决虚拟机实现而定的。当前主流的访问方式有句柄和直接指针两种。
*   句柄

&#8195;&#8195;若使用句柄访问的话，那么Java堆中将会划分出一块内存作为句柄池，reference中存储的就是对象的句柄地址，而句柄中包含了对象实例数据与类型数据各自的具体地址信息。
    ![句柄访问方式](https://upload-images.jianshu.io/upload_images/7673665-da1cf2c1f12b9d0a.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

*   直接指针

&#8195;&#8195;当使用直接指针访问，那么Java堆对象的布局中就必须考虑如何访问类型数据的相关信息，而reference中存储的直接就是对象地址。
![指针访问方式](https://upload-images.jianshu.io/upload_images/7673665-718885ea74740c48.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

&#8195;&#8195;这两种对象访问方式各有优势，**使用句柄来访问的最大坏处就是reference中存储的是稳定的句柄地址，在对象移动（垃圾回收移动对象）时只会改变句柄中的实例数据指针，而reference本身不需要修改**。
&#8195;&#8195;使用**直接指针访问方式的最大好处就是速度更快，节省了一次指针定位的时间开销，**由于对象的访问在Java中非常频繁。
