---
title: 5.Java堆溢出
tags: []
---

&#8195;&#8195;Java堆用于存储对象，只要不断的创建对象，并且保证GC Roots到对象之间有可达路径来避免垃圾回收机制清除这些对象，那么在对象数量到达最大堆的容量限制后就产生内存溢出异常。
- `-Xms`来设置Java堆容量的最小容量
- `-Xmx`来设置Java堆容量的最大容量
- `-XX:+HeapDumpOnOutOfMemoryError`参数当虚拟机发生内存溢出异常时Dump出当前的内存堆转储快照

&#8195;&#8195;当发生OutOfMemoryError时一般先通过**内存映像分析工具**堆Dump出来的堆转储快照进行分析，重点确认内存中的对象是否是必要的，先分清除是出现**内存泄漏**（Memory Leak）还是**内存溢出**（Memory Overflow）
- 内存泄漏

&#8195;&#8195;通过工具查看泄漏对象到GC Roots的引用链。找到泄漏对象是通过怎样的路径与GC Roots相关联并导致垃圾收集器无法自动回收它们的。
- 不存在泄漏

&#8195;&#8195;当内存中的对象确实还必须存活着，就应该检查虚拟机的堆参数（-Xmx与-Xms），与机器物理内存对比是否还可调大，从代码上检查是否存在某些对象生命周期过长，持有时间过长的情况。
