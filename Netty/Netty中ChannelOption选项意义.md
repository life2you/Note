---
title: Netty中ChannelOption选项意义
tags: [Netty]
---

&#8195;&#8195;无论是对于NioServerSocketChannel父通道类型还是NioSocketChannel子通道类型，都可以设置ChannelOption选项。

- SO_RCVBUF,SO_SNDBUF

&#8195;&#8195;此为TCP参数，每个TCP socket（套接字）在内核中都有一个发送缓冲区和接受缓冲区，这两参数用来设置TCP链接的缓冲区的大小，[TCP的全双工的工作模式](https://www.cnblogs.com/littleatp/p/10888454.html)以及TCP的滑动窗口便是依赖于这两个缓冲区的及其填充的状态。

- TCP_NODELAY

&#8195;&#8195;此为TCP参数，表示**立即发送数据**，默认值为`true`（Netty默认为`true`,操作系统默认为`false`）。该值用于设置Nagle算法的启用，该算法将小的碎片数据连接成更大的报文（或数据包）来最小化所发送报文的数量，如果需要发送一些较小的报文，则需要禁用该算法，Netty默认禁用该算法。

- SO_KEEPALIVE

&#8195;&#8195;此为TCP参数，表示底层TCP协议的心跳机制，`true`为连接保持心跳，默认值为`false`。该功能为TCP会主动探测空闲连接的有效性。默认的心跳间隔是7200s=2h。

- SO_REUSEADDR

&#8195;&#8195;此为TCP参数。设置为`true`时表示地址复用，默认值为`false`。以下4种情况会用到这个参数设置：

      1. 当有一个相同本地地址和端口的socket1处于`TIME_WAIT`状态时，而我们希望启动的程序socket2要占用该地址和端口。例如重启服务切需要保持先前端口时。
      2. 有多块网卡或用IP Alias技术的机器在同一个端口启动多个进程，但每个进程绑定的本地IP不能相同。
      3. 单个进程绑定相同的端口到多个socket（套接字）上，但每个socket绑定的IP不同。
      4. 完全相同的地址和端口的重复绑定，只用于UDP的广播，不用于TCP。

- SO_LINGER

&#8195;&#8195;此为TCP参数，表示关闭socket的延迟时间，默认为-1，表示禁用该功能，-1表示`socket.close()`方法立即返回，但操作系统底层将会发送缓冲区全部发送到对端。0表示`socket.close()`方法立即返回，操作系统会放弃发送缓冲区的数据，直接向对端发送RST包，对方收到复位错误。非0整数值表示调用`socket.close()`方法的线程被阻塞，直到延迟时间到来、发送缓冲区中的数据发送完毕，若超时，则会发送复位错误。

- SO_BACKLOG

&#8195;&#8195;此为TCP参数，表示服务器端接收连接的队列长度，如果队列已满，客户端连接将被拒绝。默认值：Windows=200，其他操作系统=128。

- SO_BROADCAST

&#8195;&#8195;此为TCP参数，表示设置广播模式。
